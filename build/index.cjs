"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const $=require("moment"),d=require("traverse"),o=require("chalk"),b=require("strip-ansi"),v=require("fs"),E=require("sprintf-js");let f={level:{caseControl:"upper"},event:{prefix:"> "},message:{prefixMessage:`
----- received following messages -----
`,indentStyle:"",nonInfoIndentStyle:"    > ",endStyle:", ",nonInfoEndStyle:`
`}};function I(e){d(f.level).forEach(function(t){this.key===e.key&&this.update(e.value)})}function k(e){d(f.event).forEach(function(t){this.key===e.key&&this.update(e.value)})}function F(e){d(f.message).forEach(function(t){this.key===e.key&&this.update(e.value)})}function M({level:e,service:t,event:n="",message:s=[""]}){const c=(()=>{const r=f.level.caseControl;return r==="upper"?e.toUpperCase():r==="lower"?e.toLowerCase():r==="capitalize"?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e})(),g=n?`${f.event.prefix||""}${n}`:"",m=(()=>{const{prefixMessage:r,indentStyle:a,nonInfoIndentStyle:y,endStyle:p,nonInfoEndStyle:D}=f.message,S=s.map(i=>typeof i=="object"?JSON.stringify(i,null,2):String(i));return c!=="INFO"?r+S.map(i=>`${y}${i}`).join(D):S.map(i=>`${a}${i}`).join(p)})();return{level:c,service:t,event:g,message:m}}let h={debug:o.gray.dim,info:o.cyan,warn:o.yellow,error:o.red,fatal:o.redBright.bold,success:o.green,default:o.white},w=o.blueBright,L=o.magentaBright,_={debug:o.gray.dim,info:o.white,warn:o.yellow,error:o.red,fatal:o.redBright.bold};function q(e,t){d(h).forEach(function(n){this.key===e.toLowerCase()&&this.update(t)})}function z(e){w=e}function j(e){L=e}function W(e,t){d(_).forEach(function(n){this.key===e.toLowerCase()&&this.update(t)})}function B({level:e,service:t,event:n="",message:s=[""]}){const c=h[e.toLowerCase()]||h.default,g=_[e.toLowerCase()]||o.white,m=c(e),r=w(t),a=n?L(n):"",y=[s].map(p=>g(p));return{level:m,service:r,event:a,message:y}}function O(e){return b(e)}let l=null,C=!0;function Y(e){typeof e=="boolean"&&(C=e)}function A(e){l=e||"logs/"}function P(){return l}function x(){return C}function U(e,t){if(!l){console.error("Log directory is not set. Use setLogDumpPath() to set the log directory.");return}if(!C)return;const n=`${l}/${e}.log`||`${l}/latest.log`;v.existsSync(l)||v.mkdirSync(l,{recursive:!0}),v.appendFile(n,t+`
`,s=>{s&&console.error(`minlog-js: error writing to log file:
`,s)})}function J(){const e=$(),t=e.format("YYYY-MM-DD"),n=e.format("h:mm:ss A");return{date:t,timeStamp:`${t} ${n}`}}function u(e,t,n,s){const{date:c,timeStamp:g}=J(),m=M({level:e,service:t,event:n,message:s}),r=B(m),a=E.sprintf("%s | %s | %s %s: %s",g,r.level,r.service,r.event,r.message);console.log("%s",a),x()&&U(`${c}`,O(a))}const N={info:(e,t,n)=>u("info",e,t,n),error:(e,t,n)=>u("error",e,t,n),fatal:(e,t,n)=>u("fatal",e,t,n),warn:(e,t,n)=>u("warn",e,t,n),debug:(e,t,n)=>u("debug",e,t,n),success:(e,t,n)=>u("success",e,t,n)};function T(){return N}exports.Logger=T;exports.getLogDumpDir=P;exports.isWriteFile=x;exports.setEventColor=j;exports.setEventStyles=k;exports.setIsWriteFile=Y;exports.setLevelColor=q;exports.setLevelStyles=I;exports.setLogDumpDir=A;exports.setMessageColor=W;exports.setMessageStyles=F;exports.setServiceColor=z;
